<!DOCTYPE html>
<html>
<body>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>  
 
<form>
Location:<br>
  <input type="text" name="location"><br>
</form>
    <button onclick="getWeather()">Submit</button>
    <div id="box"></div>
    
   
<script>
     var latitude;
    var longitude;
    var city;
    var state;
function getWeather() {
     var location = document.getElementsByName("location")[0].value;
    const DARK_SKY_API_KEY = "20a94cee4a0e829e9761ee9e6dc625c6";
    const LOCATION_API_KEY = "Au_bF_9s7xEZp0TZ5rYiD_3p2BWI0WdUIAT5vnLnf8CVjip4RJ9Rv7y3KDerY9nA";
    city = location.split(", ")[0];
    var cityArray = city.split(" ");
    var cityLength = cityArray.length;
    var finalCityString = "";
    for ( i = 0; i < cityLength; i++) {
      finalCityString += `%20${cityArray[i]}`;
    }
    state = location.split(", ")[1];
    var location_url = `http://dev.virtualearth.net/REST/v1/Locations?q=1${finalCityString}%20${state}&o=json&key=${LOCATION_API_KEY}`;
     $.ajax({
    url: location_url,
    success:function(data) { 
      latitude = data.resourceSets[0].resources[0].geocodePoints[0].coordinates[0];
      longitude = data.resourceSets[0].resources[0].geocodePoints[0].coordinates[1];
      var proxy = 'https://cors-anywhere.herokuapp.com/';
      var apiLinkDS = `https://api.darksky.net/forecast/20a94cee4a0e829e9761ee9e6dc625c6/${latitude},${longitude}`;
      $.get('http://dataservice.accuweather.com//locations/v1/cities/geoposition/search?apikey=yl0a52Adqm5OHzGzAZ3rDJP5RyGWR2EQ&q=42.3601%2C-71.0589&language=en-us&details=false&toplevel=false', function (data2) {
        console.log(data2.Key);
    $.get('http://dataservice.accuweather.com/forecasts/v1/daily/1day/'+data2.Key+'?apikey=yl0a52Adqm5OHzGzAZ3rDJP5RyGWR2EQ&language=en-us&details=false&metric=false', function (data) {
        console.log(data);
        document.getElementById("box").innerHTML = "";
        box.append("Tomorrow's Temperature Minimum (F): " + data.DailyForecasts[0].Temperature.Minimum.Value+ "\n\rTomorrow's Temperature Maximum (F): " + data.DailyForecasts[0].Temperature.Maximum.Value);
    });
        
    });

  }});
    var location = document.getElementsByName("location")[0].value;
    $.get('http://dataservice.accuweather.com/forecasts/v1/daily/1day/348735?apikey=yl0a52Adqm5OHzGzAZ3rDJP5RyGWR2EQ&language=en-us&details=false&metric=false', function (data) {
        console.log(data);
        document.getElementById("box").innerHTML = "";
        box.append("Tomorrow's Temperature Minimum (F): " + data.DailyForecasts[0].Temperature.Minimum.Value+ "\n\rTomorrow's Temperature Maximum (F): " + data.DailyForecasts[0].Temperature.Maximum.Value);
    });
} 
    $( document ).ready(function() {
    //getWeather();
});
</script>

</body>
</html>
